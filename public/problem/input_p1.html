<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1" />
    <link rel="stylesheet" href="../css/style.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/python/python.min.js"></script>
    <script src="index.js"></script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <title>input1</title>
</head>

<body>
<h1>文字列の入力</h1>
<hr>

<h2>問題文</h2>
<p>文字列\(S\)が入力されるので、そのまま\(S\)を出力してください。</p>
<p>入力は、<strong>変数 = input()</strong>で受け取れます。</p>

<h2>制約</h2>
<ul>
    <li>\(S\)は1以上100以下の長さ</li>
</ul>
<hr>

<h2>入力</h2>
入力は以下の形式で標準入力から与えられる。
<div class="io_format">\(S\)</div>

<h2>出力</h2>
<p>答えを出力せよ。</p>
<hr>
<h2>入力例1</h2>
<pre id="sample1_input" class="sample">abc</pre>

<h2>出力例1</h2>
<pre id="sample1_output" class="sample">abc</pre>
<p>print()で出力できます。</p>
<hr>
<!-- id が "*_input" and "*_output" の pre 要素が１組以上必要。 -->
<!-- pre.sample には自動的にコピーボタンが付く。 -->

<h2>入力例2</h2>
<pre id="sample2_input" class="sample">python</pre>

<h2>出力例2</h2>
<pre id="sample2_output" class="sample">python</pre>
<hr>

<textarea id="txt-editor"></textarea>
<p>
    <!-- ↓ button#run は必ず用意 -->
    <button id="run">実行</button>
    <input type="checkbox" id="autocopy" checked /><label for="autocopy">実行時にプログラムを自動的にコピーしておく</label>
</p>
<p>実行結果:</p>
<!-- ↓ table#result は必ず用意 -->
<table id="result">
    <thead>
    <tr>
        <th>Case Number</th>
        <th>Result</th>
        <th>Execution Time</th>
    </tr>
    </thead>
    <tbody>
    <!-- テスト結果がここに追加されます -->
    </tbody>
</table>
<script src="/socket.io/socket.io.js"></script>
<script>
    let socket = io();
    console.log('Attempting to connect to server via WebSocket.');
    const code = document.getElementById('txt-editor');
    const run = document.getElementById('run');
    const result = document.getElementById('result');

    function getFilenameWithoutExtension() {
        const path = window.location.pathname;
        const filenameWithExtension = path.split('/').pop(); // パスの最後の部分を取得
        const filename = filenameWithExtension.split('.').slice(0, -1).join('.'); // 最後のドット以降を除去
        return filename;
    }
    const identifier = getFilenameWithoutExtension();

    run.addEventListener("click", function () {
        socket.emit('run', code.value, identifier);
    });

    socket.on('connect', function() {
        console.log('Connected to server via WebSocket.');
    });
    // テーブルの内容をクリアするイベントリスナー
    const tbody = document.querySelector('#result tbody');
    socket.on('clearTable', function() {
        // tbodyの中身をすべて削除
        while (result.rows.length > 1) {
            //tbody.removeChild(tbody.firstChild);
            result.deleteRow(-1);
        }
        console.log('Table content has been cleared.');
    });
    // テーブルに行を追加するイベントリスナー
    socket.on('result', (caseNumber, res, time) => {
        console.log('Received result:', caseNumber, res, time);  // 受け取った結果のログ出力
        //console.log('Received result:', data);  // 受け取った結果のログ出力
        //result.innerHTML = `<tr><td>${caseNumber}</td><td>${res}</td><td>${time}</td></tr>`; // 結果を表示する適切な方法に応じて変更
        // テーブルに行を追加
        let row = result.insertRow(-1); // テーブルの最後に行を追加
        let cell1 = row.insertCell(0); // 最初のセルを追加
        let cell2 = row.insertCell(1); // 2番目のセルを追加
        let cell3 = row.insertCell(2); // 3番目のセルを追加

        // 各セルにデータを設定
        cell1.innerHTML = `${caseNumber}`;
        cell2.innerHTML = res;
        cell3.innerHTML = `${time}`;
    });
</script>
</body>
</html>