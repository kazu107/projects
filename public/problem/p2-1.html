<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ゲーム木改題</title>
    <link rel="stylesheet" href="../css/problem.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<header>
    <div id="top-row">
        <h1 id="problem-title">ゲーム木改題</h1>
        <!-- 解説リンク -->
        <a class="ed-rial" href="../editorial/p2-1-ed.html" target="_blank">
            <button id="explanation-button">解説</button>
        </a>
    </div>
    <div id="limits">
        <span id="time-limit">実行時間制限: 4秒</span>
        <span id="memory-limit">メモリ使用制限: 256MB</span>
    </div>
</header>
<main>
    <div id="problem-statement">
        <h2>問題文</h2>
        <!-- 問題文 -->
        <p>石が場に合計 \(N\) 個置かれています。</p>
        <p>この石を、人間とコンピュータが交互に取り去っていきます。 ただし、１回に取り去ることができる石の数は\(1個、2個、3個\)のいずれかです。人間が先に石を取ってスタートし、最後に場から石を取った方が負けとなります。</p>
        <p>このゲームで人間が勝つパターンの総数を求めてください。</p>
        <!-- 問題文 -->
        <hr>
        <h2>制約</h2>
        <ul id="constraints">
            <!-- 制約 -->
            <li>\(1 ≤ N ≤ 50\)</li>
            <!-- 制約 -->
        </ul>
        <hr>
        <h2>入力</h2>
        <!-- 入力 -->
        <p>入力は以下の形式で標準入力から与えられる。</p>
        <div class="code-container">
            <!-- 入力の形式 -->
            <div class="code-block io_format">\(N\)</div>
        </div>
        <hr>
        <h2>出力</h2>

        <!-- 出力の形式 -->
        <p>答えを出力せよ。</p>
        <hr>

        <!-- テストケース -->
        <h2>入力例 1</h2>
        <div class="code-container">
            <!-- 入力の形式 -->
            <div class="code-block io_format">3</div>
        </div>
        <h2>出力例 1</h2>
        <div class="code-container">
            <!-- 出力の形式 -->
            <div class="code-block io_format">2</div>
        </div>

        <!-- 出力例の説明 -->
        <p>(3 -> 2 -> 0), (3 -> 1 -> 0) の2つの遷移のみが勝ちうるパターンです。</p>
        <hr>

        <h2>入力例 2</h2>
        <div class="code-container">
            <!-- 入力の形式 -->
            <div class="code-block io_format">5</div>
        </div>
        <h2>出力例 2</h2>
        <div class="code-container">
            <!-- 出力の形式 -->
            <div class="code-block io_format">6</div>
        </div>

        <h2>提出欄</h2>
        <div class="code-editor-container">
            <div id="txt-editor" class="code-editor"></div>
            <button id="run" class="submit-button">提出</button>
        </div>
        <hr>
        <!-- 実行結果 -->
        <h2>実行結果</h2>
        <table id="result">
            <thead>
            <tr>
                <th>ケース番号</th>
                <th>結果</th>
                <th>実行時間 (ms)</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
</main>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
<script>
    const socket = io();
    //接続
    socket.on('connect', function() {
        console.log('Connected to server');
    });
    //結果を受信してテーブルを更新
    socket.on('result', (caseNumber, res, time) => {
        const tableBody = document.querySelector('#result tbody');
        const newRow = document.createElement('tr');
        newRow.innerHTML = `
                <td>${caseNumber}</td>
                <td>${res}</td>
                <td>${time}</td>
            `;
        tableBody.appendChild(newRow);
    });
    //テーブルをクリア
    socket.on('clearTable', function() {
        const tableBody = document.querySelector('#result tbody');
        while (tableBody.firstChild) {
            tableBody.removeChild(tableBody.firstChild);
        }
    });
    //コピー
    function copyToClipboard(elementId) {
        const code = document.getElementById(elementId).innerText;
        navigator.clipboard.writeText(code).then(() => {
            const copyMessage = document.querySelector(`#${elementId} + .copy-message`);
            copyMessage.style.visibility = 'visible';
            setTimeout(() => {
                copyMessage.style.visibility = 'hidden';
            }, 2000);
        });
    }
    //コードエディターの設定
    document.addEventListener("DOMContentLoaded", function() {
        MathJax.typesetPromise();

        // Initialize ACE Editor
        const editor = ace.edit("txt-editor");
        editor.setTheme("ace/theme/monokai");
        editor.session.setMode("ace/mode/python");
        editor.setOptions({
            fontSize: "14pt",
            showPrintMargin: false,
            enableBasicAutocompletion: true,
            enableLiveAutocompletion: true,
            enableSnippets: true,
        });
        // 提出ボタンが押されたときの処理
        document.getElementById("run").addEventListener("click", function() {
            const code = editor.getValue();
            const path = window.location.pathname;
            const pageName = path.substring(path.lastIndexOf('/') + 1, path.lastIndexOf('.'));
            console.log('Sent code:', code);
            socket.emit('run', code, pageName);
        });
    });
</script>
</body>
</html>
