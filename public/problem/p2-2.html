<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1" />
    <link rel="stylesheet" href="../css/style.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/python/python.min.js"></script>
    <script src="index.js"></script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <title>巡回セールスマン改題</title>
</head>

<body>
<h1>巡回セールスマン改題<a class="ed-rial" href="../editorial/p2-2-ed.html" target="_blank">解説</a></h1>
<hr>

<h2>問題文</h2>
<p>２次元座標上に \(N\) 個の都市があり、それらの座標 \(A_i\), \(B_i\) が与えられます。</p>
<p>都市1をスタートとしたとき、全都市を1回ずつ通って都市1に帰ってくるパターンの中での最短距離を出力してください。</p>
<h2>制約</h2>
<ul>
    <li>\(2 ≤ N ≤ 10\)</li>
    <li>\(0 ≤ A_i, B_i ≤ 1000\)</li>
    <li>\(A_i, B_i\)は小数</li>
</ul>
<hr>

<h2>入力</h2>
入力は以下の形式で標準入力から与えられる。
<div class="io_format">\(N\)
\(A_1\) \(B_1\)
\(A_2\) \(B_2\)
\(\vdots\)
\(A_N\) \(B_N\)</div>

<h2>出力</h2>
<p>答えを出力せよ。ただし、出力誤差は<code>0.0001</code>まで認められる。</p>
<hr>

<h2>入力例1</h2>
<pre id="sample1_input" class="sample">4
3.21 6.54
9.87 4.32
7.65 0.98
5.43 8.76</pre>

<h2>出力例1</h2>
<pre id="sample1_output" class="sample">20.54442</pre>
<p>1 -> 3 -> 2 -> 4が最短経路です。</p>
<hr>
<!-- id が "*_input" and "*_output" の pre 要素が１組以上必要。 -->
<!-- pre.sample には自動的にコピーボタンが付く。 -->

<h2>入力例2</h2>
<pre id="sample2_input" class="sample">6
5.07 5.99
8.78 8.27
1.68 2.33
4.89 5.58
4.84 7.23
5.36 3.25</pre>

<h2>出力例2</h2>
<pre id="sample2_output" class="sample">20.21939</pre>
<hr>

<textarea id="txt-editor"></textarea>
<p>
    <!-- ↓ button#run は必ず用意 -->
    <button id="run">実行</button>
    <input type="checkbox" id="autocopy" checked /><label for="autocopy">実行時にプログラムを自動的にコピーしておく</label>
</p>
<p>実行結果:</p>
<!-- ↓ table#result は必ず用意 -->
<table id="result">
    <thead>
    <tr>
        <th>Case Number</th>
        <th>Result</th>
        <th>Execution Time</th>
    </tr>
    </thead>
    <tbody>
    <!-- テスト結果がここに追加されます -->
    </tbody>
</table>
<script>
    const editor = CodeMirror.fromTextArea(document.getElementById("txt-editor"), {
        lineNumbers: true,
        mode: "python",
        indentUnit: 4
    })
    editor.setOption("extraKeys", {
        "Tab": function(cm) {
            if (cm.somethingSelected()) cm.indentSelection("add")
            else cm.replaceSelection(Array(cm.getOption("indentUnit") + 1).join(" "), "end", "+input")
        },
        "Shift-Tab": function(cm) {
            cm.execCommand("indentLess")
        },
        "Ctrl-Enter": function(cm) {
            OnBrowserJudge.runButtonPressed()
        }
    })
</script>
<script src="/socket.io/socket.io.js"></script>
<script>
    let socket = io();
    console.log('Attempting to connect to server via WebSocket.');
    const code = document.getElementById('txt-editor');
    const run = document.getElementById('run');
    const result = document.getElementById('result');

    function getFilenameWithoutExtension() {
        const path = window.location.pathname;
        const filenameWithExtension = path.split('/').pop(); // パスの最後の部分を取得
        const filename = filenameWithExtension.split('.').slice(0, -1).join('.'); // 最後のドット以降を除去
        return filename;
    }
    const identifier = getFilenameWithoutExtension();

    run.addEventListener("click", function () {
        socket.emit('run', code.value, identifier);
    });

    socket.on('connect', function() {
        console.log('Connected to server via WebSocket.');
    });
    // テーブルの内容をクリアするイベントリスナー
    const tbody = document.querySelector('#result tbody');
    socket.on('clearTable', function() {
        // tbodyの中身をすべて削除
        while (result.rows.length > 1) {
            //tbody.removeChild(tbody.firstChild);
            result.deleteRow(-1);
        }
        console.log('Table content has been cleared.');
    });
    // テーブルに行を追加するイベントリスナー
    socket.on('result', (caseNumber, res, time) => {
        console.log('Received result:', caseNumber, res, time);  // 受け取った結果のログ出力
        //console.log('Received result:', data);  // 受け取った結果のログ出力
        //result.innerHTML = `<tr><td>${caseNumber}</td><td>${res}</td><td>${time}</td></tr>`; // 結果を表示する適切な方法に応じて変更
        // テーブルに行を追加
        let row = result.insertRow(-1); // テーブルの最後に行を追加
        let cell1 = row.insertCell(0); // 最初のセルを追加
        let cell2 = row.insertCell(1); // 2番目のセルを追加
        let cell3 = row.insertCell(2); // 3番目のセルを追加

        // 各セルにデータを設定
        cell1.innerHTML = `${caseNumber}`;
        cell2.innerHTML = res;
        cell3.innerHTML = `${time}`;
    });
</script>
</body>
</html>